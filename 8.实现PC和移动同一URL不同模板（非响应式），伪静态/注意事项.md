8.实现PC和移动同一URL不同模板（非响应式），伪静态
<br/>
8.1首先动态化，把根目录下生成的index.html删除，并且不再使用更新主页HTML-生成静态，如果根目录的index.php不见了，去安装包复制一个
<br/>
执行以下MySQL语句：
<br/>
update dede_archives set ismake=-1;
<br/>
//将织梦所有栏目设置为"使用动态页"
<br/>
update dede_arctype set isdefault=-1;
<br/>
//将网站所有文档都设置为"仅动态"
<br/>
8.2设置伪静态
<br/>
后台-系统参数-核心设置-是否使用伪静态：选择“是”；
<br/>
8.2.1、列表页和内容页伪静态链接
<br/>
打开 /plus/list.php 找到
```php
$tid = (isset($tid) && is_numeric($tid) ? $tid : 0);
```
改成
```php
if($cfg_rewrite == 'Y')
{
    if(!is_numeric($tid))
    {
        $typedir = parse_url($tid, PHP_URL_PATH);
        $PageNo = stripos(GetCurUrl(), '.html') ? intval(str_replace('.html', '', end(explode("_", GetCurUrl())))) : 1;
        $tinfos = $dsql->GetOne("SELECT * FROM `yx_arctype` WHERE typedir='/$typedir' or typedir='{cmspath}/$typedir'");

        if(is_array($tinfos))
        {
            $tid = $tinfos['id'];
            $typeid = GetSonIds($tid);
            $row = $dsql->GetOne("Select count(id) as total From `yx_archives` where typeid in({$typeid})");
        }
        else
        {
            $tid = 0;
        }
    }
}
else
{
	$tid = (isset($tid) && is_numeric($tid) ? $tid : 0);
}
```
打开 /plus/view.php 找到
```php
$t1 = ExecTime();
```
在它下面加入
```php
if($cfg_rewrite == 'Y')
{
	if(!is_numeric($aid))
	{
        $aid = stripos(GetCurUrl(), '.html') ? str_replace('.html', '', end(explode("/", GetCurUrl()))) : 0;
		$aidpage = explode("_",$aid);
		$aid = intval($aidpage[0]);
		$pageno = intval($aidpage[1]);
	}
}
```
打开 /include/arc.listview.class.php 找到
```php
//获得上一页和下一页的链接
```
在它上面加入
```php
if($cfg_rewrite == 'Y')
{
	$purl = "";
}
else
{
	$geturl = "tid=".$this->TypeID."&TotalResult=".$this->TotalResult."&";
	$purl .= '?'.$geturl;
}
```
继续找到
```php
$plist = str_replace('.php?tid=', '-', $plist);
```
在它上面加入
```php
$tnamerule = $this->GetMakeFileRule($this->Fields['id'],"list",$this->Fields['typedir'],$this->Fields['defaultname'],$this->Fields['namerule2']);
$tnamerule = preg_replace("/^(.*)\//", '', $tnamerule);
$plist = preg_replace("/PageNo=(\d+)/i",str_replace("{page}","\\1",$tnamerule),$plist);
```
打开 /include/helpers/channelunit.helper.php 找到
```php
global $cfg_typedir_df;
```
改成
```php
global $cfg_typedir_df, $cfg_rewrite;
```
继续找到
```php
$reurl = $GLOBALS['cfg_phpurl']."/list.php?tid=".$typeid;
```
改成
```php
if($cfg_rewrite == 'Y')
{
    $reurl = $typedir.'/';
}
else
{
    //动态
    $reurl = $GLOBALS['cfg_phpurl']."/list.php?tid=".$typeid;
}
```
继续找到
```php
return $GLOBALS["cfg_plus_dir"]."/view-".$aid.'-1.html';
```
改成
```php
$articleDir = MfTypedir($typedir);
$articleRule = strtolower($namerule);
if($articleRule=='')
{
	$articleRule = strtolower($GLOBALS['cfg_df_namerule']);
}
if($typedir=='')
{
	$articleDir  = $GLOBALS['cfg_cmspath'].$GLOBALS['cfg_arcdir'];
}
$dtime = GetDateMk($timetag);
list($y, $m, $d) = explode('-', $dtime);
$arr_rpsource = array('{typedir}','{y}','{m}','{d}','{timestamp}','{aid}','{cc}');
$arr_rpvalues = array($articleDir,$y, $m, $d, $timetag, $aid, dd2char($m.$d.$aid.$y));
if($filename != '')
{
	$articleRule = dirname($articleRule).'/'.$filename.$GLOBALS['cfg_df_ext'];
}
$articleRule = str_replace($arr_rpsource,$arr_rpvalues,$articleRule);
if(preg_match("/\{p/", $articleRule))
{
	$articleRule = str_replace('{pinyin}',GetPinyin($title).'_'.$aid,$articleRule);
	$articleRule = str_replace('{py}',GetPinyin($title,1).'_'.$aid,$articleRule);
}
$articleUrl = '/'.preg_replace("/^\//", '', $articleRule);
if(preg_match("/index\.html/", $articleUrl) && $cfg_arc_dirname=='Y')
{
	$articleUrl = str_replace('index.html', '', $articleUrl);
}
return $articleUrl;
```
8.2.2、内容文章分页伪静态
<br/>
打开 /include/arc.archives.class.php 找到
```php
$PageList = preg_replace("#.php\?aid=(\d+)#i", '-\\1-1.html', $PageList);
```
有2处，改成
```php
$PageList = preg_replace("#view.php\?aid=(\d+)#i", '\\1.html', $PageList);
```
继续找到
```php
$PageList = str_replace(".php?aid=", "-", $PageList);
```
有3处，改成
```php
$PageList = str_replace("view.php?aid=", "", $PageList);
```
继续找到
```php
$PageList =  preg_replace("#&pageno=(\d+)#i", '-\\1.html', $PageList);
```
有3处，改成
```php
$PageList =  preg_replace("#&pageno=(\d+)#i", '_\\1.html', $PageList);
```
3、TAG标签伪静态链接
<br/>
打开 /include/taglib/tag.lib.php 找到
```php
$row['link'] = $cfg_cmsurl."/tags.php?/".urlencode($row['keyword'])."/";
```
改成
```php
$row['link'] = $cfg_cmsurl."/tags/".urlencode($row['keyword'])."/";
```
8.2.4、TAG标签分页伪静态链接
<br/>
打开 /include/arc.taglist.class.php 找到
```php
$this->PageNo = $GLOBALS['PageNo'];
```
在它的下面加入
```php
if($this->PageNo == 0)
{
    $this->PageNo = 1;
}
```
继续找到
```php
$prepage="";
```
在它的上面加入
```php
global $cfg_rewrite;
```
继续找到
```php
$purl .= "?/".urlencode($this->Tag);
```
改成
```php
if($cfg_rewrite == 'Y')
{
    $purl = "/tags/".urlencode($this->Tag);
}
else
{
    $purl .= "?/".urlencode($this->Tag);
}
```
8.2.5、搜索页伪静态链接
<br/>
打开 /plus/search.php 找到
```php
$mid = (isset($mid) && is_numeric($mid)) ? $mid : 0;
```
在它的下面加入
```php
if ( $mobile==1 )
{
    define('DEDEMOB', 'Y');
}
```
继续找到
```php
$t1 = ExecTime();
```
在它的下面加入
```php
$keyword = preg_replace("/-(\d+)/i",'',$keyword);
$oldkeyword = preg_replace("/-(\d+)/i",'',$oldkeyword);
```
打开 /include/arc.searchview.class.php 找到
```php
global $oldkeyword;
```
改成
```php
global $oldkeyword, $cfg_rewrite;
```
继续找到
```php
$purl .= "?".$geturl;
```
改成
```php
if($cfg_rewrite != 'Y' && !defined('DEDEMOB'))
{
    $purl .= "?".$geturl;
}
else
{
    $purl = '/search/'.urlencode($oldkeyword);
}
```
继续找到
```php
return $plist;
```
改成
```php
if($cfg_rewrite == 'Y')
{
	$plist = preg_replace("/PageNo=(\d+)/i",'-\\1.html',$plist);
}
return $plist;
```
暂时未发生问题，已上传文件最好不要直接使用，还有其他修改
<br/>
伪静态之后，栏目的文件夹不可删除，文件貌似可以删除



